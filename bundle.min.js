!function n(t,e,i){function r(o,u){if(!e[o]){if(!t[o]){var c="function"==typeof require&&require
if(!u&&c)return c(o,!0)
if(s)return s(o,!0)
var a=new Error("Cannot find module '"+o+"'")
throw a.code="MODULE_NOT_FOUND",a}var f=e[o]={exports:{}}
t[o][0].call(f.exports,function(n){var e=t[o][1][n]
return r(e||n)},f,f.exports,n,t,e,i)}return e[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o])
return r}({1:[function(n,t,e){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(n){return"function"==typeof n}function s(n){return"number"==typeof n}function o(n){return"object"==typeof n&&null!==n}function u(n){return void 0===n}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(n){if(!s(n)||n<0||isNaN(n))throw TypeError("n must be a positive number")
return this._maxListeners=n,this},i.prototype.emit=function(n){var t,e,i,s,c,a
if(this._events||(this._events={}),"error"===n&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t
var f=new Error('Uncaught, unspecified "error" event. ('+t+")")
throw f.context=t,f}if(e=this._events[n],u(e))return!1
if(r(e))switch(arguments.length){case 1:e.call(this)
break
case 2:e.call(this,arguments[1])
break
case 3:e.call(this,arguments[1],arguments[2])
break
default:s=Array.prototype.slice.call(arguments,1),e.apply(this,s)}else if(o(e))for(s=Array.prototype.slice.call(arguments,1),a=e.slice(),i=a.length,c=0;c<i;c++)a[c].apply(this,s)
return!0},i.prototype.addListener=function(n,t){var e
if(!r(t))throw TypeError("listener must be a function")
return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,r(t.listener)?t.listener:t),this._events[n]?o(this._events[n])?this._events[n].push(t):this._events[n]=[this._events[n],t]:this._events[n]=t,o(this._events[n])&&!this._events[n].warned&&(e=u(this._maxListeners)?i.defaultMaxListeners:this._maxListeners)&&e>0&&this._events[n].length>e&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),"function"==typeof console.trace&&console.trace()),this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(n,t){function e(){this.removeListener(n,e),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function")
var i=!1
return e.listener=t,this.on(n,e),this},i.prototype.removeListener=function(n,t){var e,i,s,u
if(!r(t))throw TypeError("listener must be a function")
if(!this._events||!this._events[n])return this
if(e=this._events[n],s=e.length,i=-1,e===t||r(e.listener)&&e.listener===t)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,t)
else if(o(e)){for(u=s;u-- >0;)if(e[u]===t||e[u].listener&&e[u].listener===t){i=u
break}if(i<0)return this
1===e.length?(e.length=0,delete this._events[n]):e.splice(i,1),this._events.removeListener&&this.emit("removeListener",n,t)}return this},i.prototype.removeAllListeners=function(n){var t,e
if(!this._events)return this
if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[n]&&delete this._events[n],this
if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t)
return this.removeAllListeners("removeListener"),this._events={},this}if(e=this._events[n],r(e))this.removeListener(n,e)
else if(e)for(;e.length;)this.removeListener(n,e[e.length-1])
return delete this._events[n],this},i.prototype.listeners=function(n){return this._events&&this._events[n]?r(this._events[n])?[this._events[n]]:this._events[n].slice():[]},i.prototype.listenerCount=function(n){if(this._events){var t=this._events[n]
if(r(t))return 1
if(t)return t.length}return 0},i.listenerCount=function(n,t){return n.listenerCount(t)}},{}],2:[function(n,t,e){function i(){var n=u.value,t=s.parse(n),e=s.listify(t)
c.value=JSON.stringify(e,null,4),a.value=t.map(function(n){return s.explain(n)}).join("").trim()}function r(){try{i()}catch(n){throw c.value=n.toString(),console.error(n),n}}var s=n("./parser.js"),o=(console.log,function(n){return document.getElementById(n)}),u=o("input"),c=o("json"),a=o("lisp")
u.value="\nprint 42\nprint\n  + 2\n    * 10 4\n\n+\n  * 4 3\n  * 15 2\n\n+ (* 4 3)(* 15 2\n\ndefun max2 (a b\n  cond\n    (> a b) a\n    t b\n\ndefun abs2 (x\n  cond\n    (> x 0) x\n    t (- 0 x\n\ndefun show-squares (start end\n  do\n    (i start (+ i 1\n    (> i end) (quote (done\n    format t '~A ~A~%' i (* i i\n\nshow-squares 2 5\n".trim(),u.addEventListener("input",function(){r()},!1),r()},{"./parser.js":4}],3:[function(n,t,e){var i=this&&this.__extends||function(n,t){function e(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])
n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)},i=function(n,t){for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e])},r=function(){var n=function(n){return function(t){var e=function(){this.init&&this.init.apply(this,arguments)},r={}
return"function"==typeof t?t(r,n.prototype):r=t,r.__proto__=n.prototype,e.prototype=r,i(e,n),e}}
return Function.prototype.make=function(t){return n(this)(t)},Function.prototype.setp=function(n){return Object.assign(this,n)},n(function(){})}()
t.exports=r
var s=function(n,t){if(!n)throw"assert failed"+(t?": "+t.toString():"")}
!function(){var n=r(function(n){n.init=function(){this.legs=4},n.say=function(){return this.sound}})
n.kill=function(n){return n.sound+"...bang!"}
var t=r({init:function(){this.legs=4},say:function(){return this.sound}})
s(4===(new t).legs)
var e=n.make(function(n,t){n.init=function(){t.init.call(this),this.sound="baa"}})
s("baa"===(new e).say())
var i=function(n){n.say=function(){return this.sound+"!!!"}},o=e.make(i)
s((new o).say(),"baa!!!")
var u=n.make({get speed(){return 10*this.legs},set speed(n){this.legs=n/10}})
s(40===(new u).speed)
var u=n.make(function(n){Object.defineProperty(n,"speed",{get:function(){return 10*this.legs},set:function(n){this.legs=n/10}})})
s(40===(new u).speed)
var c=u.make(function(n,t){n.init=function(){t.init.call(this),this.sound="bark"}}),a=new c
s(40===a.speed),s("bark"===a.say()),s("bark...bang!"===c.kill(a))}()},{}],4:[function(n,t,e){function i(n){var t=function(n){return o("list"===n.type,function(){return n.children.map(t)},"string"===n.type,function(){return n.string},"symbol"===n.type,function(){return n.symbol},function(){throw new Error("unknown node type")})()}
return n.map(t)}var r=n("./meik.js"),s=function(n){return function(t,e,i,r,s){return n(this,t,e,i,r,s)}},o=function(){for(var n=arguments,t=0;t<n.length;t+=2){if(void 0===n[t+1])return n[t]
if(n[t])return n[t+1]}},u=console.log,c=function(){},a=function(n){for(var t=[],e=0;e<n;e++)t.push(e)
return t},f=function(n,t){return n[n.length-1-(t||0)]}
c(o(!1,"1f",!0,"2f","3f"))
var h=("\n__\n= x 2\n= x\n  + 3 2 y\n\n= x (+ 3 2 y\n* x (+ 1.5 6 (* 2 3\n\n+ (* 3 3) (* 4 4\n  * 5 5\n  * 6 6\n\n+\n  (3) 4 5\n  3 4 5\n  (3 4 5\n\n* (+ 1 2)(+ 3 4)\n___\n+ 'holy' 'fuc ing' spaces\nprint x\nwhile\n__> x 0.2\n__= x\n____- x 178\n__\niif\n__> x 2\n__- x 1\n__+ x\n____* 5 x".replace(/_/g," "),function(n){throw new Error(n)}),l=r(function(n){n.init=function(n,t){if("symbol"===n)this.symbol=t
else if("string"===n)this.string=t
else{if("list"!==n)throw new Error("unsupported node type")
this.children=[]}this.type=n},n.setParent=function(n){if(!n&&null!==n)throw new Error("parent invalid in setParent")
return this.parent=n,null!==n&&n.children.push(this),this}}),p=function(){return new l("list")},d=n("events"),v=function(n){n.init=s(function(n){return n.reset()})},m=d.make(v).make(function(n){n.reset=s(function(n){return n.start()}),n.start=s(function(n){n.cache=""}),n.in=s(function(n,t){n.cache+=t}),n.end=s(function(n){c("(ssm)symbol",n.cache),n.emit("symbol",n.cache)})}),g=m.make(function(n){n.end=s(function(n){c("(ssm)string",n.cache),n.emit("string",n.cache)})}),_=d.make(v).make(function(n){n.reset=function(){this.rootnode=null,this.currnode=this.rootnode},n.append=function(n){n.setParent(this.currnode)},n.push=function(){c("(lsm)->"),this.currnode=p().setParent(this.currnode)},n.pop=function(){c("(lsm)<-")
var n=this.currnode
this.currnode=n.parent,this.currnode===this.rootnode&&this.emit("list",n)}}),y=d.make(v).make(function(n){n.reset=function(){this.count=0},n.inc=s(function(n){n.count++,n.emit("inc"),c("(brc)+")}),n.dec=s(function(n){n.count--,n.check(),n.emit("dec"),c("(brc)-")}),n.check=s(function(n){if(n.count<0)throw new Error("ref underflow")}),n.zero=s(function(n){return 0===n.count})}),b=y.make(function(n){n.closebraces=function(){for(;this.count>0;)this.dec()}}),w=d.make(v).make(function(n){n.reset=function(){c("(ism)reset"),this.stack=[],this.count=0},n.start=function(){c("(ism)start"),this.count=0},n.in=s(function(n){n.count++}),n.end=function(){this.got_indent(this.count)},n.last=s(function(n){return f(n.stack)}),n.push=function(n){this.stack.push(n),c("(ism.stack)push",n,this.stack)},n.pop=function(){0===this.stack.length&&h("indentation stack underflow")
var n=this.stack.pop()
return c("(ism.stack)pop",n,this.stack),n},n.got_indent=function(n){if(c("(ism.stack)got_indent",n),n>this.last()||0===this.stack.length)this.push(n),this.emit("push")
else{for(this.emit("pop");n<this.last();)this.pop(),this.emit("pop")
if(n>this.last())throw"indentation imbalance"
this.emit("push")}},n.end_indent=function(){for(;0!==this.stack.length;)this.pop(),this.emit("pop")}}),k=function(){function n(){u(N.smap)}function t(n){c("begin parse"),f(),T=[]
for(var t=0;t<n.length;t++)N.eat(n[t])
return N.eat("\0"),c("end parse"),T}var e=new _,i=new w,s=new m,a=new g,f=function(){s.reset(),e.reset(),i.reset(),N.reset(),a.reset(),p.reset()},p=new b
s.on("symbol",function(n){e.append(new l("symbol",n))}),a.on("string",function(n){e.append(new l("string",n))})
var d=function(){i.end_indent()}
i.on("push",function(){e.push()}),i.on("pop",function(){e.pop()}),p.on("inc",function(){e.push()}).on("dec",function(){e.pop()})
var v=function(n,t){return t.indexOf(n)>=0},y=function(n){return function(t){return t===n}},k=function(n){return"a"<=n&&n<="z"||"A"<=n&&n<="Z"||"0"<=n&&n<="9"||v(n,":.<>?=_-+*/!%^&@$\\")},x=y(" "),L=y("\n"),q=y("\0"),E=y("'"),j=function(n){return"quoting"===N.state&&!(L(n)||q(n)||E(n))},O=y("("),A=y(")"),P=function(n){return o(j(n),"string",O(n),"lbr",A(n),"rbr",k(n),"symbol",x(n),"space",L(n),"newline",q(n),"eos",E(n),"quote","invalid-category")},M=r(function(n){n.init=function(){this.reset(),this.smap={}},n.reset=function(){this.state="linestart"},n.eat=function(n){var t=P(n),e=this.smap[this.state]
e||h("unexpected state: "+this.state)
var i=e[t]
i||h("handler not found for '"+n+"' of category: "+t+" on state "+this.state),i(n)},n.reg=function(n){var t=this,e="string"==typeof n?[n]:n,i=function(n,r,s){return e.map(function(e){t.smap[e]=t.smap[e]||{},t.smap[e][n]=function(n){t.state=r,s(n)}}),i}
return i}}),N=new M
N.reg("linestart")("symbol","symboling",function(n){i.start(),i.end(),s.start(),s.in(n)})("space","indenting",function(n){i.start(),i.in()}),N.reg("indenting")("symbol","symboling",function(n){i.end(),s.start(),s.in(n)})("space","indenting",function(n){i.in()})("quote","quoting",function(n){i.end(),a.start()}),N.reg("symboling")("symbol","symboling",function(n){s.in(n)})("space","spacing",function(n){s.end()})("newline","linestart",function(n){s.end(),p.closebraces()}),N.reg("spacing")("symbol","symboling",function(n){s.start(),s.in(n)})("space","spacing",function(n){})("quote","quoting",function(n){a.start()}),N.reg("quoting")("string","quoting",function(n){a.in(n)})("quote","quoted",function(n){a.end()}),N.reg("quoted")("space","spacing",function(n){}),N.reg("symboling")("lbr","spacing",function(n){s.end(),p.inc()}),N.reg("linestart")("lbr","spacing",function(n){i.start(),i.end(),p.inc()}),N.reg("indenting")("lbr","spacing",function(n){i.end(),p.inc()}),N.reg(["spacing","quoted"])("lbr","spacing",function(n){p.inc()}),N.reg("symboling")("rbr","spacing",function(n){s.end(),p.dec()}),N.reg(["spacing","quoted"])("rbr","spacing",function(n){p.dec()}),N.reg(["linestart","spacing","indenting","quoted"])("newline","linestart",function(n){p.closebraces()})("eos","eos",function(n){p.closebraces(),d()}),N.reg(["symboling"])("eos","eos",function(n){s.end(),p.closebraces(),d()})
var T=[]
return e.on("list",function(n){T.push(n)}),{parse:t,show_state_map:n}}()
t.exports=k
var x=function(n){return q(a(4*n).map(function(n){return" "}).join(""))},L="",q=function(n){L+=n},E=function(n,t){t=t||0,o("symbol"===n.type,function(){q(" "+n.symbol+" ")},"string"===n.type,function(){q(" (str)'"+n.string+"' ")},"list"===n.type,function(){q("\n"),x(t),q("("),n.children.map(function(n){E(n,t+1)}),q(")")},function(){throw new Error("unknown node type")})()}
k.explain=function(n){return L="",E(n),L},k.listify=i},{"./meik.js":3,events:1}]},{},[2])
